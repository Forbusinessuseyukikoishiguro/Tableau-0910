<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€²æ—ç®¡ç† Excelãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ - Tableau Publicç”¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .data-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 5px solid #3498db;
        }
        .data-section h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: 0.9em;
        }
        th {
            background: #3498db;
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        tr:hover {
            background: #e8f4f8;
        }
        .status-completed { background: #2ecc71; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; }
        .status-progress { background: #f39c12; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; }
        .status-delayed { background: #e74c3c; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; }
        .status-notstarted { background: #95a5a6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; }
        .download-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            border-radius: 8px;
            color: white;
        }
        .download-btn {
            background: white;
            color: #27ae60;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .tableau-tips {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .tableau-tips h4 {
            margin-top: 0;
        }
        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .tip-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 5px;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š é€²æ—ç®¡ç†ç”¨Excelãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿</h1>
            <p>Tableau Publicã§å³åº§ã«ä½¿ãˆã‚‹å®Ÿè·µçš„ãªã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</p>
        </div>

        <div class="download-section">
            <h3>ğŸš€ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
            <p>ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€Tableau Publicã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</p>
            <button class="download-btn" onclick="downloadExcel()">ğŸ“¥ Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            <button class="download-btn" onclick="downloadCSV()">ğŸ“„ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        </div>

        <div class="data-section">
            <h3>ğŸ“‹ ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¹ã‚¯</h3>
            <table id="mainTable">
                <thead>
                    <tr>
                        <th>ã‚¿ã‚¹ã‚¯ID</th>
                        <th>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</th>
                        <th>ã‚¿ã‚¹ã‚¯å</th>
                        <th>ãƒ•ã‚§ãƒ¼ã‚º</th>
                        <th>æ‹…å½“è€…</th>
                        <th>é–‹å§‹æ—¥</th>
                        <th>çµ‚äº†äºˆå®šæ—¥</th>
                        <th>å®Ÿçµ‚äº†æ—¥</th>
                        <th>é€²æ—ç‡</th>
                        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th>å„ªå…ˆåº¦</th>
                        <th>äºˆå®šå·¥æ•°</th>
                        <th>å®Ÿç¸¾å·¥æ•°</th>
                        <th>éƒ¨ç½²</th>
                    </tr>
                </thead>
                <tbody id="mainTableBody">
                </tbody>
            </table>
        </div>

        <div class="data-section">
            <h3>ğŸ‘¥ ã‚µãƒ–ãƒ†ãƒ¼ãƒ–ãƒ«: ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼</h3>
            <table id="memberTable">
                <thead>
                    <tr>
                        <th>æ‹…å½“è€…ID</th>
                        <th>æ‹…å½“è€…å</th>
                        <th>éƒ¨ç½²</th>
                        <th>å½¹è·</th>
                        <th>ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«</th>
                        <th>æ™‚çµ¦å˜ä¾¡</th>
                        <th>ç¨¼åƒç‡</th>
                    </tr>
                </thead>
                <tbody id="memberTableBody">
                </tbody>
            </table>
        </div>

        <div class="tableau-tips">
            <h4>ğŸ¯ Tableau Publicã§ã®æ´»ç”¨Tips</h4>
            <div class="tips-grid">
                <div class="tip-item">
                    <strong>1. ãƒ‡ãƒ¼ã‚¿æ¥ç¶š</strong><br>
                    ã€ŒConnect to Dataã€â†’ã€ŒMicrosoft Excelã€ã‚’é¸æŠ
                </div>
                <div class="tip-item">
                    <strong>2. æ¨å¥¨ãƒãƒ£ãƒ¼ãƒˆ</strong><br>
                    ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆã€ãƒãƒ¼ãƒ³ãƒ€ã‚¦ãƒ³ã€é€²æ—ãƒ¡ãƒ¼ã‚¿ãƒ¼
                </div>
                <div class="tip-item">
                    <strong>3. è¨ˆç®—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¾‹</strong><br>
                    é…å»¶æ—¥æ•°: DATEDIFF('day',[çµ‚äº†äºˆå®šæ—¥],TODAY())
                </div>
                <div class="tip-item">
                    <strong>4. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®š</strong><br>
                    ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€æœŸé–“ã€æ‹…å½“è€…ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
                </div>
            </div>
        </div>

        <div class="data-section">
            <h3>ğŸ“ˆ æƒ³å®šã•ã‚Œã‚‹åˆ†æãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
            <ul>
                <li><strong>é€²æ—åˆ†æ</strong>: ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥ã®é€²æ—çŠ¶æ³</li>
                <li><strong>ãƒªã‚½ãƒ¼ã‚¹åˆ†æ</strong>: æ‹…å½“è€…åˆ¥ã®ä½œæ¥­è² è·ã¨ç¨¼åƒçŠ¶æ³</li>
                <li><strong>äºˆå®Ÿç®¡ç†</strong>: äºˆå®šå·¥æ•°vså®Ÿç¸¾å·¥æ•°ã®æ¯”è¼ƒ</li>
                <li><strong>é…å»¶åˆ†æ</strong>: é…å»¶è¦å› ã¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®š</li>
                <li><strong>ã‚³ã‚¹ãƒˆåˆ†æ</strong>: éƒ¨ç½²åˆ¥ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥ã®ã‚³ã‚¹ãƒˆé…åˆ†</li>
            </ul>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        const projects = ['ECã‚µã‚¤ãƒˆãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«', 'CRMã‚·ã‚¹ãƒ†ãƒ å°å…¥', 'ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤æ§‹ç¯‰', 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–', 'ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™º'];
        const phases = ['è¦ä»¶å®šç¾©', 'è¨­è¨ˆ', 'é–‹ç™º', 'ãƒ†ã‚¹ãƒˆ', 'ãƒªãƒªãƒ¼ã‚¹'];
        const members = ['ç”°ä¸­å¤ªéƒ', 'ä½è—¤èŠ±å­', 'éˆ´æœ¨ä¸€éƒ', 'å±±ç”°ç¾å’²', 'ä¼Šè—¤å¥å¤ª', 'ä¸­æ‘ã•ãã‚‰', 'å°æ—ç›´æ¨¹', 'é«˜æ©‹æ„›', 'æ¸¡è¾ºå¤§è¼”', 'æ¾æœ¬çµè¡£'];
        const departments = ['é–‹ç™ºéƒ¨', 'ã‚·ã‚¹ãƒ†ãƒ éƒ¨', 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¨é€²éƒ¨'];
        const statuses = ['å®Œäº†', 'é€²è¡Œä¸­', 'é…å»¶', 'æœªé–‹å§‹'];
        const priorities = ['é«˜', 'ä¸­', 'ä½'];

        // ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        const mainData = [];
        for (let i = 1; i <= 50; i++) {
            const startDate = new Date(2024, Math.floor(Math.random() * 3), Math.floor(Math.random() * 28) + 1);
            const duration = Math.floor(Math.random() * 30) + 5;
            const endDate = new Date(startDate.getTime() + duration * 24 * 60 * 60 * 1000);
            const progress = Math.floor(Math.random() * 100);
            const status = progress === 100 ? 'å®Œäº†' : progress > 0 ? 'é€²è¡Œä¸­' : 'æœªé–‹å§‹';
            
            mainData.push({
                ã‚¿ã‚¹ã‚¯ID: `T${String(i).padStart(3, '0')}`,
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: projects[Math.floor(Math.random() * projects.length)],
                ã‚¿ã‚¹ã‚¯å: `ã‚¿ã‚¹ã‚¯${i}_${phases[Math.floor(Math.random() * phases.length)]}`,
                ãƒ•ã‚§ãƒ¼ã‚º: phases[Math.floor(Math.random() * phases.length)],
                æ‹…å½“è€…: members[Math.floor(Math.random() * members.length)],
                é–‹å§‹æ—¥: startDate.toISOString().split('T')[0],
                çµ‚äº†äºˆå®šæ—¥: endDate.toISOString().split('T')[0],
                å®Ÿçµ‚äº†æ—¥: status === 'å®Œäº†' ? new Date(endDate.getTime() + (Math.random() - 0.5) * 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] : '',
                é€²æ—ç‡: progress,
                ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: status,
                å„ªå…ˆåº¦: priorities[Math.floor(Math.random() * priorities.length)],
                äºˆå®šå·¥æ•°: Math.floor(Math.random() * 40) + 8,
                å®Ÿç¸¾å·¥æ•°: Math.floor(Math.random() * 45) + 5,
                éƒ¨ç½²: departments[Math.floor(Math.random() * departments.length)]
            });
        }

        // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        const memberData = members.map((member, index) => ({
            æ‹…å½“è€…ID: `M${String(index + 1).padStart(3, '0')}`,
            æ‹…å½“è€…å: member,
            éƒ¨ç½²: departments[Math.floor(Math.random() * departments.length)],
            å½¹è·: ['ä¸»ä»»', 'ä¿‚é•·', 'èª²é•·', 'ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼'][Math.floor(Math.random() * 4)],
            ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«: ['åˆç´š', 'ä¸­ç´š', 'ä¸Šç´š', 'ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ'][Math.floor(Math.random() * 4)],
            æ™‚çµ¦å˜ä¾¡: Math.floor(Math.random() * 3000) + 2000,
            ç¨¼åƒç‡: Math.floor(Math.random() * 40) + 60
        }));

        // ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
        function renderTable(data, tableBodyId) {
            const tbody = document.getElementById(tableBodyId);
            tbody.innerHTML = '';
            
            data.slice(0, 10).forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    if (typeof value === 'string' && ['å®Œäº†', 'é€²è¡Œä¸­', 'é…å»¶', 'æœªé–‹å§‹'].includes(value)) {
                        const statusClass = {
                            'å®Œäº†': 'status-completed',
                            'é€²è¡Œä¸­': 'status-progress',
                            'é…å»¶': 'status-delayed',
                            'æœªé–‹å§‹': 'status-notstarted'
                        }[value];
                        td.innerHTML = `<span class="${statusClass}">${value}</span>`;
                    } else {
                        td.textContent = value;
                    }
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
        }

        renderTable(mainData, 'mainTableBody');
        renderTable(memberData, 'memberTableBody');

        // Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadExcel() {
            const wb = XLSX.utils.book_new();
            
            // ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ
            const ws1 = XLSX.utils.json_to_sheet(mainData);
            XLSX.utils.book_append_sheet(wb, ws1, "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¹ã‚¯");
            
            // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ
            const ws2 = XLSX.utils.json_to_sheet(memberData);
            XLSX.utils.book_append_sheet(wb, ws2, "ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼");
            
            // ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ
            const masterData = [
                {é …ç›®: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ', å€¤: projects.join(', ')},
                {é …ç›®: 'ãƒ•ã‚§ãƒ¼ã‚º', å€¤: phases.join(', ')},
                {é …ç›®: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', å€¤: statuses.join(', ')},
                {é …ç›®: 'å„ªå…ˆåº¦', å€¤: priorities.join(', ')},
                {é …ç›®: 'éƒ¨ç½²', å€¤: departments.join(', ')}
            ];
            const ws3 = XLSX.utils.json_to_sheet(masterData);
            XLSX.utils.book_append_sheet(wb, ws3, "ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿");
            
            XLSX.writeFile(wb, "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—ç®¡ç†_ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿.xlsx");
        }

        // CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadCSV() {
            const csv = convertToCSV(mainData);
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—ç®¡ç†_ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function convertToCSV(data) {
            const headers = Object.keys(data[0]);
            const csvHeaders = headers.join(',');
            const csvRows = data.map(row => 
                headers.map(header => `"${row[header]}"`).join(',')
            );
            return csvHeaders + '\n' + csvRows.join('\n');
        }
    </script>
</body>
</html>
